{"ast":null,"code":"var mongoose=require('mongoose');var passportLocalMongoose=require(\"passport-local-mongoose\");var bcrypt=require('bcrypt');// define the userSchema\nvar userSchema=new mongoose.Schema({username:{type:String,required:true},password:{type:String,required:true},join_date:{type:Date,default:Date.now},role:{type:String,required:true},role_id:{type:String,required:true},theme:{type:String,default:'default',required:true}});userSchema.plugin(passportLocalMongoose);userSchema.methods.verifyPassword=function(password,callback){bcrypt.compare(password,this.password,function(err,valid){callback(err,valid);});};var SALT_FACTOR=10;// hash password before saving\nuserSchema.pre('save',function save(next){var user=this;// go to next if password field has not been modified\nif(!user.isModified('password')){return next();}// auto-generate salt/hash\nbcrypt.hash(user.password,SALT_FACTOR,function(err,hash){if(err){return next(err);}//replace password with hash\nuser.password=hash;next();});});// compile the measurementSchemas into Model\nvar User=mongoose.model('User',userSchema);module.exports={User:User};","map":{"version":3,"names":["mongoose","require","passportLocalMongoose","bcrypt","userSchema","Schema","username","type","String","required","password","join_date","Date","default","now","role","role_id","theme","plugin","methods","verifyPassword","callback","compare","err","valid","SALT_FACTOR","pre","save","next","user","isModified","hash","User","model","module","exports"],"sources":["/Users/lieo/diabetes/CUT2DMTest/src/user.js"],"sourcesContent":["const mongoose = require('mongoose')\nvar passportLocalMongoose=require(\"passport-local-mongoose\");\nconst bcrypt = require('bcrypt')\n\n// define the userSchema\nconst userSchema = new mongoose.Schema({\n    username: {type: String, required: true},\n    password: {type: String, required: true},\n    join_date: {type: Date, default: Date.now},\n    role: {type: String, required: true},\n    role_id: {type: String, required: true},\n    theme: {type: String, default:'default', required: true}\n});\n\nuserSchema.plugin(passportLocalMongoose);\n\nuserSchema.methods.verifyPassword = function (password, callback) {\n    bcrypt.compare(password, this.password, (err, valid) => {\n        callback(err, valid)\n    })\n}\n\nconst SALT_FACTOR = 10\n\n// hash password before saving\nuserSchema.pre('save', function save(next) {\n    const user = this// go to next if password field has not been modified\n    if (!user.isModified('password')) {\n        return next()\n    }\n\n    // auto-generate salt/hash\n    bcrypt.hash(user.password, SALT_FACTOR, (err, hash) => {\n        if (err) {\n            return next(err)\n        }\n        //replace password with hash\n        user.password = hash\n        next()\n    })\n})\n\n// compile the measurementSchemas into Model\nconst User = mongoose.model('User', userSchema)\n\nmodule.exports = {User}"],"mappings":"AAAA,GAAMA,SAAQ,CAAGC,OAAO,CAAC,UAAU,CAAC,CACpC,GAAIC,sBAAqB,CAACD,OAAO,CAAC,yBAAyB,CAAC,CAC5D,GAAME,OAAM,CAAGF,OAAO,CAAC,QAAQ,CAAC,CAEhC;AACA,GAAMG,WAAU,CAAG,GAAIJ,SAAQ,CAACK,MAAM,CAAC,CACnCC,QAAQ,CAAE,CAACC,IAAI,CAAEC,MAAM,CAAEC,QAAQ,CAAE,IAAI,CAAC,CACxCC,QAAQ,CAAE,CAACH,IAAI,CAAEC,MAAM,CAAEC,QAAQ,CAAE,IAAI,CAAC,CACxCE,SAAS,CAAE,CAACJ,IAAI,CAAEK,IAAI,CAAEC,OAAO,CAAED,IAAI,CAACE,GAAG,CAAC,CAC1CC,IAAI,CAAE,CAACR,IAAI,CAAEC,MAAM,CAAEC,QAAQ,CAAE,IAAI,CAAC,CACpCO,OAAO,CAAE,CAACT,IAAI,CAAEC,MAAM,CAAEC,QAAQ,CAAE,IAAI,CAAC,CACvCQ,KAAK,CAAE,CAACV,IAAI,CAAEC,MAAM,CAAEK,OAAO,CAAC,SAAS,CAAEJ,QAAQ,CAAE,IAAI,CAC3D,CAAC,CAAC,CAEFL,UAAU,CAACc,MAAM,CAAChB,qBAAqB,CAAC,CAExCE,UAAU,CAACe,OAAO,CAACC,cAAc,CAAG,SAAUV,QAAQ,CAAEW,QAAQ,CAAE,CAC9DlB,MAAM,CAACmB,OAAO,CAACZ,QAAQ,CAAE,IAAI,CAACA,QAAQ,CAAE,SAACa,GAAG,CAAEC,KAAK,CAAK,CACpDH,QAAQ,CAACE,GAAG,CAAEC,KAAK,CAAC,CACxB,CAAC,CAAC,CACN,CAAC,CAED,GAAMC,YAAW,CAAG,EAAE,CAEtB;AACArB,UAAU,CAACsB,GAAG,CAAC,MAAM,CAAE,QAASC,KAAI,CAACC,IAAI,CAAE,CACvC,GAAMC,KAAI,CAAG,IAAI;AACjB,GAAI,CAACA,IAAI,CAACC,UAAU,CAAC,UAAU,CAAC,CAAE,CAC9B,MAAOF,KAAI,EAAE,CACjB,CAEA;AACAzB,MAAM,CAAC4B,IAAI,CAACF,IAAI,CAACnB,QAAQ,CAAEe,WAAW,CAAE,SAACF,GAAG,CAAEQ,IAAI,CAAK,CACnD,GAAIR,GAAG,CAAE,CACL,MAAOK,KAAI,CAACL,GAAG,CAAC,CACpB,CACA;AACAM,IAAI,CAACnB,QAAQ,CAAGqB,IAAI,CACpBH,IAAI,EAAE,CACV,CAAC,CAAC,CACN,CAAC,CAAC,CAEF;AACA,GAAMI,KAAI,CAAGhC,QAAQ,CAACiC,KAAK,CAAC,MAAM,CAAE7B,UAAU,CAAC,CAE/C8B,MAAM,CAACC,OAAO,CAAG,CAACH,IAAI,CAAJA,IAAI,CAAC"},"metadata":{},"sourceType":"module"}